<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome</title>
  <link rel="stylesheet" href="./style/style.css">
</head>
<body>
  <header>
    <h1>Bienvenido</h1>
  </header>
  <form action="">
    <h2>Ingresa el nombre de un Pa√≠s</h2>
    <label for="">
      <input list="countries" placeholder="Nombre de un Pais">
      <datalist id="countries">
        
      </datalist>
    </label>
  </form>

  <div id="app"></div>
  <script >
    const API = 'https://travelbriefing.org/countries.json'
    const allCountry = []

    const request = fetch(API)
      .then(response => response.json())
      .then(data => {
        data.forEach((item) => {
          const selectCountry = document.querySelector('#countries')
          const optionsCountries = document.createElement('option')
          optionsCountries.textContent = item.name
          allCountry.push(optionsCountries)
          selectCountry.append(optionsCountries)
        })
      })
      .then(() => {
        const referenceInput = document.querySelector('input')
          referenceInput.addEventListener('change', () => {
          const selectedCountry = document.querySelector('input').value

          const requestCountry = fetch(`https://travelbriefing.org/${selectedCountry}?format=json`)
          .then(response => response.json())
          .then(data => {
            /* Start Section Presentation Country */
            const sectionPresentation = document.createElement('section')
            
            const nameCountry = document.createElement('h2')
            nameCountry.textContent = data.names.name

            const fullNameCountry = document.createElement('h3')
            fullNameCountry.textContent = data.names.full

            const neighbors = document.createElement('p')
            neighbors.textContent = `Other countries in the neighborhood of ${data.names.name} are ${data.neighbors.map((data) => data.name)}`

            sectionPresentation.append(nameCountry, fullNameCountry, neighbors)

            /* End Section Presentation Country */





            /* Start Section Advice Travel */

            const sectionAdvise = document.createElement('section')

            const titleAdvise = document.createElement('h3')
            titleAdvise.textContent = 'Travel Advise'

            const firstAdvise = document.createElement('p')
            firstAdvise.textContent = data.advise.UA.advise

            const urlFirstAdvise = document.createElement('a')
            urlFirstAdvise.href = data.advise.UA.url
            urlFirstAdvise.target = '_blank'
            urlFirstAdvise.rel = 'noopener'
            urlFirstAdvise.textContent = 'Full report'

            const secondAdvise = document.createElement('p')
            const urlSecondAdvise = document.createElement('a')
            
            if(data.advise.CA === undefined) {
                console.log('Hola Mundo para rellenar')
              } else {
                secondAdvise.textContent = data.advise.CA.advise
                urlSecondAdvise.href = data.advise.CA.url
              }
              
            urlSecondAdvise.target = '_blank'
            urlSecondAdvise.rel = 'noopener'
            urlSecondAdvise.textContent = 'Full report'

            sectionAdvise.append(titleAdvise, firstAdvise, urlFirstAdvise, secondAdvise, urlSecondAdvise)

            /* End Section Advise Travel */





            /* Start Section Water */
            const sectionWater = document.createElement('section')

            const titleWater = document.createElement('h3')
            titleWater.textContent = 'Drinking Water'

            const stateWater = document.createElement('p')
            stateWater.textContent = `Drinkig tap water in ${data.names.name} is ${data.water.short}.`
            
            sectionWater.append(titleWater, stateWater)

            /* End Section Water */

            /* Start Section  TimeZone*/
            const sectionTimeZone = document.createElement('section')

            const titleTimeZone = document.createElement('h3')
            titleTimeZone.textContent = 'Timezone'

            const actualTimeZone = document.createElement('p')
            actualTimeZone.textContent = data.timezone.name

            sectionTimeZone.append(titleTimeZone, actualTimeZone)

            /* End Section TimeZone */
            
            /* Start Section Visa */
            const sectionVisa = document.createElement('section')

            const titleVisa = document.createElement('h3')
            titleVisa.textContent = 'Visa requirements'

            sectionVisa.append(titleVisa)

            /* End Section Visa */

            /* Start Section Currency */
            const sectionCurrency = document.createElement('section')

            const titleCurrency = document.createElement('h3')
            titleVisa.textContent = 'Currency'

            const actualCurrency = document.createElement('p')
            actualCurrency.textContent = `The currency in ${data.names.name} is ${data.currency.name} (${data.currency.symbol}) `

            const formCurrency = document.createElement('div')
              /* First Container */
            const formCurrencyRate = document.createElement('div')
            const subtitleCurrency = document.createElement('h4')
            subtitleCurrency.textContent = data.currency.name
            const inputCurrency = document.createElement('input')
            inputCurrency.type = 'number'
            formCurrencyRate.append(subtitleCurrency, inputCurrency) 
              /* Second Container */
            const formCompare = document.createElement('div')
            const countryList = document.createElement('input')
            countryList.setAttribute('list', 'countryRate')
            countryList.placeholder = ''
            const dataCountry = document.createElement('datalist')
            dataCountry.id = 'countryRate'
            const optionCountry = document.createElement('option')
            console.log(allCountry.map((data) => data.textContent))
            allCountry.map((data) => optionCountry.textContent = data.textContent)
            countryList.append(dataCountry)
            dataCountry.append(optionCountry)
            formCompare.append(countryList)

            formCurrency.append(formCurrencyRate, formCompare)

            sectionCurrency.append(titleCurrency, actualCurrency, formCurrency)

            /* End Section Currency */


            
            const container = document.createElement('div')
            container.append(sectionPresentation, sectionAdvise, sectionWater, sectionTimeZone, sectionCurrency)

            const mainContainer = document.querySelector('#app')
            mainContainer.append(container)
          })
        })
        
      })
  </script>
</body>
</html>